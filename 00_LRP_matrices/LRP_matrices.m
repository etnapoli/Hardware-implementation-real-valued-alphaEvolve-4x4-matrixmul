% LRP_matrices.m
% Defines the L, R, and P matrices for the 4x4 matrix multiplication algorithm
%
% LRP matrices are taken from the github repo:
% [1] J.-G. Dumas, B. Grenet, C. Pernet, and A. Sedoglavic, 
% “Plinopt: A collection of C++ routines handling linear & bilinear programs,” 
%  https://github.com/jgdumas/plinopt, Jan. 2024.
%
% that refers to the paper: 
% [2] J.-G. Dumas, C. Pernet, and A. Sedoglavic, 
% “A non-commutative algorithm for multiplying 4×4 matrices using 
% 48 non-complex multiplications,” arXiv preprint arXiv:2506.13242, June 16 2025.
%


% -------- R (48x16) --------
R=[ -1  -1   1  -1   1   1  -1   1   1   1  -1   1   1   1  -1   1;
    -1   1   1  -1   0   0   0   0   0   0   0   0   0   0   0   0;
     0   0   0   0   0   0   0   0   1  -1  -1  -1   0   0   0   0;
     0   0   0   0   0   0   0   0  -1  -1   1   1  -1  -1  -1  -1;
    -1   1  -1  -1  -1   1  -1  -1  -1   1  -1  -1   1  -1   1   1;
     1  -1  -1   1   1  -1  -1   1  -1   1   1  -1   1  -1  -1   1;
     0   0   0   0   0   0   0   0   0   0   0   0   1  -1  -1  -1;
    -1   1  -1   1  -1   1  -1   1  -1   1  -1   1   1  -1   1  -1;
     0   0   1   1   0   0  -1  -1   1  -1   0   0   1  -1   0   0;
     1   1   1  -1   0   0   0   0   0   0   0   0   0   0   0   0;
    -1   1   1  -1  -1   1   1  -1  -1   1   1  -1   1  -1  -1   1;
     0  -1   0  -1   1   0   1   0   0   1   0   1   1   0   1   0;
     0   0   0   0   0   0   0   0   1  -1   1   1   0   0   0   0;
     0   0   0   0   0   0   0   0   1   1  -1  -1   0   0   0   0;
    -1  -1   1  -1   0   0   0   0  -1   1   1   1   0   0   0   0;
    -1   1  -1   1  -1   1  -1   1   1  -1   1  -1  -1   1  -1   1;
     1   1  -1  -1   1   1   1   1   0   0   0   0   0   0   0   0;
    -1  -1   1   1   1   1  -1  -1   1   1  -1  -1   1   1  -1  -1;
     0  -1   0   1   1   0  -1   0   0   1   0  -1   1   0  -1   0;  
    -1  -1   1   1   1   1  -1  -1  -1  -1   1   1  -1  -1   1   1;
     0   0   0   0   0   0   0   0   1  -1  -1   1   0   0   0   0;
     1   0   1   0   0  -1   0  -1   1   0   1   0   0   1   0   1;
     0   0   0   0   0   0   0   0   0   0   0   0  -1   1  -1  -1;
     1  -1   1   1  -1   1  -1  -1   1  -1   1   1   1  -1   1   1;
     1  -1   0   0   1  -1   0   0   0   0   1   1   0   0  -1  -1;
     1   1   1  -1  -1  -1  -1   1   1   1   1  -1   1   1   1  -1;
     0   0   0   0   1   1   1   1   0   0   0   0   0   0   0   0;
     0   0  -1   1   0   0   1  -1  -1  -1   0   0  -1  -1   0   0;
     1  -1  -1  -1  -1   1   1   1  -1   1   1   1  -1   1   1   1;
     0   0   0   0   0   0   0   0   0   0   0   0   1   1   1   1;
     0   0   0   0   1  -1   1  -1   0   0   0   0   0   0   0   0;
    -1   0   1   0   0   1   0  -1  -1   0   1   0   0  -1   0   1;
    -1   1   1   1  -1   1   1   1   1  -1  -1  -1  -1   1   1   1;
     0   0   0   0   0   0   0   0   1  -1  -1   1   1  -1   1  -1;
     1   1   0   0   1   1   0   0   0   0   1  -1   0   0  -1   1;
     1   1   1   1  -1  -1  -1  -1   1   1   1   1   1   1   1   1;
     0   0   0   0  -1  -1  -1   1   0   0   0   0   0   0   0   0;
     0   0   0   0   1   1   1  -1   0   0   0   0   1  -1   1   1;
     0   0   0   0  -1  -1   1  -1   0   0   0   0   0   0   0   0;
     1  -1  -1   1   1  -1   1  -1   0   0   0   0   0   0   0   0;
     1   1   1   1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1;
     0   0   0   0   0   0   0   0   0   0   0   0   1  -1   1  -1;
    -1  -1   1  -1   0   0   0   0   0   0   0   0   0   0   0   0;
     1   1   1  -1   0   0   0   0   1  -1   1   1   0   0   0   0;
    -1  -1   1  -1  -1  -1   1  -1   1   1  -1   1  -1  -1   1  -1;
     1   1   1  -1   1   1   1  -1   1   1   1  -1  -1  -1  -1   1;
    -1  -1   1   1   0   0   0   0   0   0   0   0   0   0   0   0;
     0   0   0   0   1   1  -1   1   0   0   0   0   1  -1  -1  -1];

% -------- P (48x16) --------
P= [0   0  -1  -1   0   0   0   0   0   0   0   0   0   0   0   0;
 0   0   0   0   1  -1   0   0   0   0   0   0   1  -1   0   0;
 0   0   0   0   1   0   1   0   0   0   0   0   0   0   0   0;
 0   0   0   1   0   0   1   0   0   0   1  -1   0   0   0   0;
 1   1   0   0   0   0   0   0  -1  -1   0   0  -1  -1   0   0;
 0   0   0   0   0   1   0   1   0   0   0   0   0   1   0   1;
 0   0   0   0   0  -1   0   1   0   0   0   0   0   0   0   0;
 1   0   1   0   0   0   0   0   0   0   0   0  -1   0  -1   0;
-1   1   1   1  -1   1  -1  -1   1  -1  -1  -1   1  -1  -1  -1;
 0   0   0   0   1   0  -1   0   1   0  -1   0   1   0  -1   0;
 0   0   0   0   0   1   0  -1   0   0   0   0   0   1   0  -1;
-1   1   1   1  -1  -1   1  -1  -1  -1   1  -1   1  -1  -1  -1;
 1   0  -1   0   0   0   0   0  -1   0   1   0  -1   0   1   0;
 0   0   1  -1   0   0   0   0   0   0  -1   1   0   0   0   0;
 0   0  -1   0   1   0   0   0   0   0   0   0   0   0   0   0;
 1   0  -1   0   0   0   0   0   0   0   0   0  -1   0   1   0;
 0   1   0   0  -1   0   0   0  -1  -1   0   0   0   0   0   0;  
 0   1   0   1   0   0   0   0   0  -1   0  -1   0   0   0   0;
 1   1  -1   1  -1   1   1   1  -1  -1   1  -1  -1   1   1   1;
 0  -1   0   1   0   0   0   0   0   1   0  -1   0   0   0   0;
 0   0   0   0   0   0   1   1   0   0   0   0   0   0   1   1;
 1  -1   1   1   1   1   1  -1   1   1   1  -1  -1   1  -1  -1;
 0   1   0   1   0   0   0   0   0  -1   0  -1   0  -1   0  -1;
 1  -1   0   0   0   0   0   0  -1   1   0   0  -1   1   0   0;
 1   1  -1   1   1   1   1  -1  -1  -1   1  -1  -1  -1   1  -1;
 0   0   0   0   0   0  -1  -1   0   0  -1  -1   0   0  -1  -1;
 0   0   0   0  -1  -1   0   0  -1  -1   0   0   0   0   0   0;
-1   1  -1  -1   1  -1  -1  -1   1  -1  -1  -1   1  -1  -1  -1;
 0   0   0   0  -1   1   0   0   0   0   0   0   0   0   0   0;
 0   0   0   0   0   0  -1   1   0   0  -1   1   0   0   0   0;
 1  -1   0   0   0   0   0   0   0   0   0   0  -1   1   0   0;
-1  -1  -1   1   1  -1   1   1   1   1   1  -1   1  -1   1   1;
 0   0   0   0  -1  -1   0   0   0   0   0   0   0   0   0   0;
 0   0   1   0   0   0   0  -1   0   0   0   0   0   0  -1  -1;
 1   1   1  -1  -1  -1   1  -1  -1  -1   1  -1  -1  -1   1  -1;
 0   0   0   0  -1   0  -1   0  -1   0  -1   0   0   0   0   0;
 0   0   0   0   0  -1   0  -1   0  -1   0  -1   0  -1   0  -1;
 0   1   0   0   0   0   0  -1   0  -1   0  -1   0  -1   0  -1;
 0   1   0  -1   0   0   0   0   0   0   0   0   0   0   0   0;
-1   0   0   0   0  -1   0   0   0   0   0   0   1  -1   0   0;
 0   0   0   0   1   0  -1   0   1   0  -1   0   0   0   0   0;
 0   0   1   1   0   0   0   0   0   0   0   0   0   0  -1  -1;
 1   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0;
-1   0   0   0   0   0  -1   0   1   0  -1   0   1   0  -1   0;
 0   0  -1   1   0   0   0   0   0   0   0   0   0   0   0   0;
 0   0   0   0   0   0  -1   1   0   0  -1   1   0   0  -1   1;
 1   1   0   0   0   0   0   0  -1  -1   0   0   0   0   0   0;
 0   0   0   1   0   1   0   0   0   0   0   0   0   0   0   0];
% -------- L (16x48) --------
L=[0 -1/2 0 0 0 0 0 0 1/8 1/2 0 1/4 0 0 1/4 -1/4 0 0 0 0 0 0 0 0 -1/8 0 0 1/8 1/4 0 -1/2 0 0 0 1/8 0 0 -1/4 -1/2 -1/2 -1/4 0 0 -1/4 -1/4 0 0 1/4;
   0 0 0 -1/2 0 0 1/2 0 -1/8 0 0 -1/4 -1/2 1/2 -1/4 1/4 0 0 0 0 0 0 0 0 1/8 0 0 -1/8 -1/4 1/2 0 0 0 0 -1/8 0 0 1/4 0 0 1/4 0 0 -1/4 1/4 0 0 1/4;
   0 0 0 1/4 0 0 0 0 -1/8 0 0 1/8 1/2 -1/2 1/4 -1/4 -1/4 0 -1/8 1/4 0 1/8 0 -1/4 -1/8 0 0 1/8 0 0 -1/2 -1/8 0 1/4 1/8 0 0 -1/4 -1/2 -1/4 0 0 0 1/4 -1/4 0 0 1/4;
   0 -1/2 0 1/4 0  0 -1/2  0  1/8 1/2 -1/4  1/8  0 0 1/4 0 1/4 0 1/8 0 0 -1/8 0 0 -1/8 0 0 1/8 1/4 -1/2 0 -1/8 0 -1/4 -1/8 0 0 -1/4 0 -1/4 -1/4 0 0 -1/4 0 -1/4 0 -1/4;
   0 1/2 0 0 0 1/4 0 0 -1/8 0 0 0 0 0 -1/4 0 0 1/4 -1/4 0 0 0 0 0 1/8 0 0 1/8 -1/4 0 1/2 0 0 0 1/8 0 1/2 1/4 0 1/2 0 0 -1/2 1/4 -1/4 0 0 -1/4;
   0 0 -1/2 -1/2 0 -1/4 0 0 1/8 0 0 0 0 1/2 -1/4 0 0 -1/4 1/4 0 0 0 1/2 0 -1/8 0 0 -1/8 1/4 1/2 0 0 0 0 -1/8 0 0 1/4 0 0 0 0 0 -1/4 1/4 0 0 1/4;
   0 0 1/2 1/4 0 1/4 0 0 1/8 0 0 1/8 0 -1/2 1/4 0 -1/4 0 -1/8 0 0 -1/8 0 1/4 1/8 0 0 1/8 0 0 1/2 1/8 0 -1/4 1/8 -1/4 1/2 1/4 0 1/4 0 0 0 1/4 -1/4 0 0 -1/4;
   0 1/2 0 1/4 0 0 0 -1/4 -1/8 0 0 -1/8 0 0 -1/4 0 1/4 1/4 -1/8 0 0 -1/8 -1/2 0 1/8 0 0 1/8 -1/4 -1/2 0 -1/8 0 1/4 -1/8 0 0 -1/4 0 1/4 0 0 -1/2 1/4 0 -1/4 0 -1/4;
   1/4 0 0 0 0 0 0 0 1/8 1/2  0 1/4  0  0 -1/4 -1/4 1/2  0  0  0  0  0  0  0 -1/8  0 -1/2  1/8  0  0  0  0 1/4  0  1/8  0  0 -1/4 1/2  0 -1/4  0  0 -1/4  0  0 1/2 -1/4;
  -1/4  0  0  0  0  0 -1/2  0 -1/8  0  0 -1/4 -1/2  0 1/4 1/4  0  0  0  0 -1/2  0  0  0  1/8  0  0 -1/8  0  0  0  0 -1/4 -1/2 -1/8  0  0 1/4  0  0 1/4 1/2  0 -1/4  0  0  0 -1/4;
   0  0  0 1/4  0  0  0  0  1/8  0  0  1/8 1/2  0 -1/4 -1/4 1/4  0  1/8 -1/4 1/2  1/8  0  0 -1/8 -1/4 -1/2 -1/8  0  0  0  1/8 1/4 1/4  1/8  0  0 -1/4 1/2 1/4  0  0  0 1/4  0  0  0 -1/4;
   1/4  0  0 -1/4 1/4  0 1/2  0  1/8 1/2 1/4  1/8  0  0 -1/4  0 1/4  0 -1/8  0  0 -1/8  0  0  1/8  0  0  1/8  0  0  0  1/8  0 1/4  1/8  0  0 -1/4  0 -1/4 -1/4 -1/2  0 -1/4  0  0 1/2 1/4;
  -1/4  0  0  0  0 -1/4  0  0  1/8  0  0  0  0  0 -1/4  0 1/2 -1/4 1/4  0  0  0  0  0 -1/8  0 -1/2 -1/8  0  0  0  0 1/4  0 -1/8  0 -1/2 -1/4  0  0  0  0 -1/2 -1/4  0  0 1/2 -1/4;
   1/4  0 -1/2  0  0 1/4  0  0 -1/8  0  0  0  0  0 -1/4  0  0 1/4 -1/4  0 1/2  0 -1/2  0  1/8  0  0  1/8  0  0  0  0 -1/4 1/2  1/8  0  0 -1/4  0  0  0 -1/2  0 1/4  0  0  0 1/4;
   0  0 1/2 1/4  0 -1/4  0  0  1/8  0  0  1/8  0  0 1/4  0 1/4  0  1/8  0 -1/2 -1/8  0  0 -1/8 1/4 -1/2  1/8  0  0  0 -1/8 1/4 -1/4 -1/8 -1/4 -1/2 -1/4  0 -1/4  0  0  0 -1/4  0  0  0 -1/4;
  -1/4  0  0 -1/4 1/4  0  0 -1/4  1/8  0  0 -1/8  0  0 -1/4  0 1/4 -1/4  1/8  0  0 -1/8 1/2  0  1/8  0  0 -1/8  0  0  0  1/8  0 -1/4 -1/8  0  0 1/4  0 1/4  0 1/2 -1/2 -1/4  0  0 1/2 -1/4];
